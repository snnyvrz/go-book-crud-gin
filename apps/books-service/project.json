{
    "$schema": "../../node_modules/nx/schemas/project-schema.json",
    "name": "books-service",
    "root": "apps/books-service",
    "sourceRoot": "apps/books-service",
    "projectType": "application",

    "targets": {
        "serve": {
            "executor": "nx:run-commands",
            "dependsOn": ["swagger"],
            "options": {
                "command": "air",
                "cwd": "apps/books-service"
            },
            "cache": false
        },

        "swagger": {
            "executor": "nx:run-commands",
            "options": {
                "command": "go run github.com/swaggo/swag/cmd/swag@latest init -d cmd/server,internal/handler,internal/model,internal/validation -o internal/docs",
                "cwd": "apps/books-service"
            },
            "outputs": ["{projectRoot}/internal/docs"]
        },
        "test": {
            "executor": "nx:run-commands",
            "options": {
                "command": "mkdir -p coverage && go test -coverprofile=coverage/coverage.out ./...",
                "cwd": "apps/books-service"
            },
            "inputs": ["default"],
            "outputs": ["{projectRoot}/coverage"]
        },
        "integration-test": {
            "executor": "nx:run-commands",
            "options": {
                "command": "go test -tags=integration ./...",
                "cwd": "apps/books-service"
            },
            "inputs": ["default"],
            "outputs": []
        },
        "coverage": {
            "executor": "nx:run-commands",
            "options": {
                "command": "go tool cover -html=coverage/coverage.out -o coverage/coverage.html",
                "cwd": "apps/books-service"
            },
            "dependsOn": ["test"],
            "cache": false,
            "outputs": ["{projectRoot}/coverage"]
        }
    }
}
